import {
  calculateProfit,
  calculateMarginPercent,
  calculateLineTotal,
} from "@/utils/calculations";
import type { Customer } from "@/shared/interface/customer";
import type { Item } from "@/shared/interface/item";
import type { Expense } from "@/shared/interface/expense";
import type { Invoice } from "@/shared/interface/invoice";
import type { Payment } from "@/shared/interface/payment";

// ─── Customers ───────────────────────────────────────────────────────────────

export const MOCK_CUSTOMERS: Customer[] = [
  {
    id: "cust-001",
    code: "C-001",
    name: "Emeka Okafor",
    email: "emeka.okafor@gmail.com",
    phone: "+234 801 234 5678",
    type: "individual",
    status: "active",
    address: "12 Broad Street",
    city: "Lagos",
    state: "Lagos",
    country: "Nigeria",
    totalInvoices: 3,
    totalRevenue: 485000,
    outstandingBalance: 120000,
    createdAt: "2025-01-10",
  },
  {
    id: "cust-002",
    code: "C-002",
    name: "Ngozi Adeyemi",
    email: "ngozi.adeyemi@yahoo.com",
    phone: "+234 802 345 6789",
    type: "individual",
    status: "active",
    address: "45 Victoria Island",
    city: "Lagos",
    state: "Lagos",
    country: "Nigeria",
    totalInvoices: 2,
    totalRevenue: 220000,
    outstandingBalance: 0,
    createdAt: "2025-01-15",
  },
  {
    id: "cust-003",
    code: "C-003",
    name: "Chukwudi Motors Ltd",
    email: "info@chukwudimotors.ng",
    phone: "+234 803 456 7890",
    type: "company",
    status: "active",
    address: "78 Trans-Amadi",
    city: "Port Harcourt",
    state: "Rivers",
    country: "Nigeria",
    totalInvoices: 5,
    totalRevenue: 1250000,
    outstandingBalance: 380000,
    createdAt: "2024-11-20",
  },
  {
    id: "cust-004",
    code: "C-004",
    name: "Aisha Bello",
    email: "aisha.bello@outlook.com",
    phone: "+234 804 567 8901",
    type: "individual",
    status: "active",
    address: "23 Shehu Shagari Way",
    city: "Abuja",
    state: "FCT",
    country: "Nigeria",
    totalInvoices: 1,
    totalRevenue: 95000,
    outstandingBalance: 95000,
    createdAt: "2025-02-01",
  },
  {
    id: "cust-005",
    code: "C-005",
    name: "Rabbar Fleet Services",
    email: "fleet@rabbarservices.ng",
    phone: "+234 805 678 9012",
    type: "company",
    status: "active",
    address: "5 Admiralty Way",
    city: "Lekki",
    state: "Lagos",
    country: "Nigeria",
    totalInvoices: 4,
    totalRevenue: 875000,
    outstandingBalance: 210000,
    createdAt: "2024-10-05",
  },
  {
    id: "cust-006",
    code: "C-006",
    name: "Olumide Fashola",
    email: "olumide.fashola@gmail.com",
    phone: "+234 806 789 0123",
    type: "individual",
    status: "inactive",
    address: "18 Adeniyi Jones",
    city: "Ikeja",
    state: "Lagos",
    country: "Nigeria",
    totalInvoices: 1,
    totalRevenue: 68000,
    outstandingBalance: 0,
    createdAt: "2024-09-15",
  },
  {
    id: "cust-007",
    code: "C-007",
    name: "AutoCare Nigeria Ltd",
    email: "contact@autocareng.com",
    phone: "+234 807 890 1234",
    type: "company",
    status: "active",
    address: "102 Otigba Street",
    city: "Ikeja",
    state: "Lagos",
    country: "Nigeria",
    totalInvoices: 6,
    totalRevenue: 1890000,
    outstandingBalance: 450000,
    createdAt: "2024-08-10",
  },
  {
    id: "cust-008",
    code: "C-008",
    name: "Fatima Usman",
    email: "fatima.usman@hotmail.com",
    phone: "+234 808 901 2345",
    type: "individual",
    status: "active",
    address: "31 Ahmadu Bello Way",
    city: "Kaduna",
    state: "Kaduna",
    country: "Nigeria",
    totalInvoices: 2,
    totalRevenue: 145000,
    outstandingBalance: 50000,
    createdAt: "2025-01-28",
  },
];

// ─── Items / Services ─────────────────────────────────────────────────────────

export const MOCK_ITEMS: Item[] = [
  {
    id: "item-001",
    code: "ITM-001",
    name: "Full Vehicle Inspection",
    description: "Comprehensive 80-point vehicle inspection with report",
    type: "service",
    unit: "session",
    unitPrice: 45000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-01",
  },
  {
    id: "item-002",
    code: "ITM-002",
    name: "Engine Oil Change",
    description: "Full synthetic oil change with filter replacement",
    type: "service",
    unit: "session",
    unitPrice: 18000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-01",
  },
  {
    id: "item-003",
    code: "ITM-003",
    name: "Brake Pad Set (Front)",
    description: "OEM-quality front brake pad set",
    type: "product",
    unit: "set",
    unitPrice: 32000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-01",
  },
  {
    id: "item-004",
    code: "ITM-004",
    name: "Car Battery",
    description: "75Ah maintenance-free battery",
    type: "product",
    unit: "unit",
    unitPrice: 65000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-01",
  },
  {
    id: "item-005",
    code: "ITM-005",
    name: "AC Service & Recharge",
    description: "Air conditioning system service and gas recharge",
    type: "service",
    unit: "session",
    unitPrice: 28000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-15",
  },
  {
    id: "item-006",
    code: "ITM-006",
    name: "Tyre (All-Season 205/65R16)",
    description: "Premium all-season tyre",
    type: "product",
    unit: "unit",
    unitPrice: 55000,
    taxRate: 7.5,
    status: "active",
    createdAt: "2024-09-15",
  },
];

// ─── Expenses ─────────────────────────────────────────────────────────────────

export const MOCK_EXPENSES: Expense[] = [
  {
    id: "exp-001",
    expenseNumber: "EXP-2025-001",
    title: "Brake pads procurement",
    category: "parts",
    vendor: "AutoParts Nigeria",
    amount: 18000,
    expenseDate: "2025-01-10",
    linkedInvoiceId: "inv-001",
    linkedInvoiceNumber: "INV-2025-001",
    status: "approved",
    addedBy: "Samuel A.",
    createdAt: "2025-01-10",
  },
  {
    id: "exp-002",
    expenseNumber: "EXP-2025-002",
    title: "Technician overtime pay",
    category: "labour",
    vendor: undefined,
    amount: 12000,
    expenseDate: "2025-01-12",
    linkedInvoiceId: "inv-001",
    linkedInvoiceNumber: "INV-2025-001",
    status: "approved",
    addedBy: "Samuel A.",
    createdAt: "2025-01-12",
  },
  {
    id: "exp-003",
    expenseNumber: "EXP-2025-003",
    title: "Workshop electricity bill",
    category: "utilities",
    vendor: "EKEDC",
    amount: 45000,
    expenseDate: "2025-01-15",
    status: "approved",
    addedBy: "Ifeoma O.",
    createdAt: "2025-01-15",
  },
  {
    id: "exp-004",
    expenseNumber: "EXP-2025-004",
    title: "Engine oil & filter (INV-002)",
    category: "parts",
    vendor: "Total Nigeria",
    amount: 8500,
    expenseDate: "2025-01-18",
    linkedInvoiceId: "inv-002",
    linkedInvoiceNumber: "INV-2025-002",
    status: "approved",
    addedBy: "David M.",
    createdAt: "2025-01-18",
  },
  {
    id: "exp-005",
    expenseNumber: "EXP-2025-005",
    title: "Marketing flyers printing",
    category: "marketing",
    vendor: "QuickPrint Lagos",
    amount: 22000,
    expenseDate: "2025-01-20",
    status: "approved",
    addedBy: "Ifeoma O.",
    createdAt: "2025-01-20",
  },
  {
    id: "exp-006",
    expenseNumber: "EXP-2025-006",
    title: "Parts for INV-003 repair",
    category: "parts",
    vendor: "AutoParts Nigeria",
    amount: 35000,
    expenseDate: "2025-01-22",
    linkedInvoiceId: "inv-003",
    linkedInvoiceNumber: "INV-2025-003",
    status: "approved",
    addedBy: "Samuel A.",
    createdAt: "2025-01-22",
  },
  {
    id: "exp-007",
    expenseNumber: "EXP-2025-007",
    title: "Staff transport allowance",
    category: "transport",
    amount: 15000,
    expenseDate: "2025-01-31",
    status: "approved",
    addedBy: "Ifeoma O.",
    createdAt: "2025-01-31",
  },
  {
    id: "exp-008",
    expenseNumber: "EXP-2025-008",
    title: "AC gas for INV-004",
    category: "parts",
    vendor: "CoolTech Supplies",
    amount: 9000,
    expenseDate: "2025-02-05",
    linkedInvoiceId: "inv-004",
    linkedInvoiceNumber: "INV-2025-004",
    status: "approved",
    addedBy: "David M.",
    createdAt: "2025-02-05",
  },
  {
    id: "exp-009",
    expenseNumber: "EXP-2025-009",
    title: "Overhead — workshop rent",
    category: "overhead",
    vendor: "Landlord",
    amount: 120000,
    expenseDate: "2025-02-01",
    status: "approved",
    addedBy: "Ifeoma O.",
    createdAt: "2025-02-01",
  },
  {
    id: "exp-010",
    expenseNumber: "EXP-2025-010",
    title: "Battery procurement",
    category: "parts",
    vendor: "AutoParts Nigeria",
    amount: 48000,
    expenseDate: "2025-02-10",
    linkedInvoiceId: "inv-005",
    linkedInvoiceNumber: "INV-2025-005",
    status: "pending",
    addedBy: "Samuel A.",
    createdAt: "2025-02-10",
  },
];

// ─── Invoices ─────────────────────────────────────────────────────────────────

function buildInvoice(
  id: string,
  invoiceNumber: string,
  customer: Invoice["customer"],
  issueDate: string,
  dueDate: string,
  lineItems: Omit<Invoice["lineItems"][number], "lineTotal">[],
  status: Invoice["status"],
  amountPaid: number,
  linkedExpenseIds: string[],
  notes?: string,
): Invoice {
  const itemsWithTotal = lineItems.map((li) => ({
    ...li,
    lineTotal: calculateLineTotal(li.quantity, li.unitPrice, li.taxRate),
  }));

  const subtotal = itemsWithTotal.reduce(
    (s, li) => s + li.quantity * li.unitPrice,
    0,
  );
  const taxTotal = itemsWithTotal.reduce(
    (s, li) => s + li.quantity * li.unitPrice * (li.taxRate / 100),
    0,
  );
  const totalAmount = subtotal + taxTotal;
  const amountDue = totalAmount - amountPaid;

  const totalLinkedExpenses = MOCK_EXPENSES.filter((e) =>
    linkedExpenseIds.includes(e.id),
  ).reduce((s, e) => s + e.amount, 0);

  const profit = calculateProfit(totalAmount, totalLinkedExpenses);
  const marginPercent = calculateMarginPercent(profit, totalAmount);

  return {
    id,
    invoiceNumber,
    customerId: customer.id,
    customer,
    issueDate,
    dueDate,
    lineItems: itemsWithTotal,
    subtotal,
    taxTotal,
    totalAmount,
    amountPaid,
    amountDue,
    status,
    linkedExpenseIds,
    totalLinkedExpenses,
    profit,
    marginPercent,
    notes,
    createdAt: issueDate,
  };
}

export const MOCK_INVOICES: Invoice[] = [
  buildInvoice(
    "inv-001",
    "INV-2025-001",
    {
      id: "cust-001",
      name: "Emeka Okafor",
      email: "emeka.okafor@gmail.com",
      phone: "+234 801 234 5678",
    },
    "2025-01-10",
    "2025-01-25",
    [
      {
        id: "li-001-1",
        itemId: "item-001",
        description: "Full Vehicle Inspection",
        quantity: 1,
        unitPrice: 45000,
        taxRate: 7.5,
      },
      {
        id: "li-001-2",
        itemId: "item-003",
        description: "Brake Pad Set (Front)",
        quantity: 1,
        unitPrice: 32000,
        taxRate: 7.5,
      },
    ],
    "paid",
    82687.5,
    ["exp-001", "exp-002"],
    "Urgent service — fleet vehicle",
  ),
  buildInvoice(
    "inv-002",
    "INV-2025-002",
    {
      id: "cust-002",
      name: "Ngozi Adeyemi",
      email: "ngozi.adeyemi@yahoo.com",
      phone: "+234 802 345 6789",
    },
    "2025-01-18",
    "2025-02-01",
    [
      {
        id: "li-002-1",
        itemId: "item-002",
        description: "Engine Oil Change",
        quantity: 1,
        unitPrice: 18000,
        taxRate: 7.5,
      },
      {
        id: "li-002-2",
        itemId: "item-005",
        description: "AC Service & Recharge",
        quantity: 1,
        unitPrice: 28000,
        taxRate: 7.5,
      },
    ],
    "paid",
    49450,
    ["exp-004"],
  ),
  buildInvoice(
    "inv-003",
    "INV-2025-003",
    {
      id: "cust-003",
      name: "Chukwudi Motors Ltd",
      email: "info@chukwudimotors.ng",
      phone: "+234 803 456 7890",
    },
    "2025-01-22",
    "2025-02-06",
    [
      {
        id: "li-003-1",
        itemId: "item-001",
        description: "Full Vehicle Inspection",
        quantity: 2,
        unitPrice: 45000,
        taxRate: 7.5,
      },
      {
        id: "li-003-2",
        itemId: "item-006",
        description: "Tyre (All-Season)",
        quantity: 4,
        unitPrice: 55000,
        taxRate: 7.5,
      },
    ],
    "partial",
    150000,
    ["exp-006"],
    "Fleet inspection + tyre replacement",
  ),
  buildInvoice(
    "inv-004",
    "INV-2025-004",
    {
      id: "cust-004",
      name: "Aisha Bello",
      email: "aisha.bello@outlook.com",
      phone: "+234 804 567 8901",
    },
    "2025-02-05",
    "2025-02-20",
    [
      {
        id: "li-004-1",
        itemId: "item-005",
        description: "AC Service & Recharge",
        quantity: 1,
        unitPrice: 28000,
        taxRate: 7.5,
      },
      {
        id: "li-004-2",
        itemId: "item-001",
        description: "Full Vehicle Inspection",
        quantity: 1,
        unitPrice: 45000,
        taxRate: 7.5,
      },
    ],
    "sent",
    0,
    ["exp-008"],
  ),
  buildInvoice(
    "inv-005",
    "INV-2025-005",
    {
      id: "cust-005",
      name: "Rabbar Fleet Services",
      email: "fleet@rabbarservices.ng",
      phone: "+234 805 678 9012",
    },
    "2025-02-10",
    "2025-02-25",
    [
      {
        id: "li-005-1",
        itemId: "item-004",
        description: "Car Battery",
        quantity: 2,
        unitPrice: 65000,
        taxRate: 7.5,
      },
      {
        id: "li-005-2",
        itemId: "item-002",
        description: "Engine Oil Change",
        quantity: 2,
        unitPrice: 18000,
        taxRate: 7.5,
      },
    ],
    "overdue",
    0,
    ["exp-010"],
    "Fleet maintenance — 2 vehicles",
  ),
  buildInvoice(
    "inv-006",
    "INV-2025-006",
    {
      id: "cust-007",
      name: "AutoCare Nigeria Ltd",
      email: "contact@autocareng.com",
      phone: "+234 807 890 1234",
    },
    "2025-02-12",
    "2025-02-27",
    [
      {
        id: "li-006-1",
        itemId: "item-001",
        description: "Full Vehicle Inspection",
        quantity: 3,
        unitPrice: 45000,
        taxRate: 7.5,
      },
      {
        id: "li-006-2",
        itemId: "item-003",
        description: "Brake Pad Set (Front)",
        quantity: 3,
        unitPrice: 32000,
        taxRate: 7.5,
      },
    ],
    "draft",
    0,
    [],
    "Pending customer confirmation",
  ),
  buildInvoice(
    "inv-007",
    "INV-2025-007",
    {
      id: "cust-008",
      name: "Fatima Usman",
      email: "fatima.usman@hotmail.com",
      phone: "+234 808 901 2345",
    },
    "2025-02-15",
    "2025-03-01",
    [
      {
        id: "li-007-1",
        itemId: "item-006",
        description: "Tyre (All-Season)",
        quantity: 2,
        unitPrice: 55000,
        taxRate: 7.5,
      },
    ],
    "sent",
    0,
    [],
  ),
];

// ─── Payments ─────────────────────────────────────────────────────────────────

export const MOCK_PAYMENTS: Payment[] = [
  {
    id: "pay-001",
    paymentNumber: "PAY-2025-001",
    invoiceId: "inv-001",
    customerId: "cust-001",
    customer: { name: "Emeka Okafor" },
    invoiceNumber: "INV-2025-001",
    amount: 82687.5,
    paymentMethod: "bank_transfer",
    paymentDate: "2025-01-24",
    reference: "BT-2025-0124-001",
    status: "completed",
    createdAt: "2025-01-24",
  },
  {
    id: "pay-002",
    paymentNumber: "PAY-2025-002",
    invoiceId: "inv-002",
    customerId: "cust-002",
    customer: { name: "Ngozi Adeyemi" },
    invoiceNumber: "INV-2025-002",
    amount: 49450,
    paymentMethod: "pos",
    paymentDate: "2025-01-31",
    reference: "POS-0131-9821",
    status: "completed",
    createdAt: "2025-01-31",
  },
  {
    id: "pay-003",
    paymentNumber: "PAY-2025-003",
    invoiceId: "inv-003",
    customerId: "cust-003",
    customer: { name: "Chukwudi Motors Ltd" },
    invoiceNumber: "INV-2025-003",
    amount: 100000,
    paymentMethod: "bank_transfer",
    paymentDate: "2025-02-05",
    reference: "BT-2025-0205-009",
    notes: "Partial payment — balance to follow",
    status: "completed",
    createdAt: "2025-02-05",
  },
  {
    id: "pay-004",
    paymentNumber: "PAY-2025-004",
    invoiceId: "inv-003",
    customerId: "cust-003",
    customer: { name: "Chukwudi Motors Ltd" },
    invoiceNumber: "INV-2025-003",
    amount: 50000,
    paymentMethod: "cash",
    paymentDate: "2025-02-12",
    status: "completed",
    createdAt: "2025-02-12",
  },
  {
    id: "pay-005",
    paymentNumber: "PAY-2025-005",
    invoiceId: "inv-004",
    customerId: "cust-004",
    customer: { name: "Aisha Bello" },
    invoiceNumber: "INV-2025-004",
    amount: 78812.5,
    paymentMethod: "card",
    paymentDate: "2025-02-19",
    reference: "CARD-0219-7743",
    status: "pending",
    createdAt: "2025-02-18",
  },
  {
    id: "pay-006",
    paymentNumber: "PAY-2025-006",
    invoiceId: "inv-007",
    customerId: "cust-008",
    customer: { name: "Fatima Usman" },
    invoiceNumber: "INV-2025-007",
    amount: 50000,
    paymentMethod: "bank_transfer",
    paymentDate: "2025-02-20",
    reference: "BT-2025-0220-003",
    notes: "First instalment",
    status: "completed",
    createdAt: "2025-02-20",
  },
];

// ─── Dashboard Stats ──────────────────────────────────────────────────────────

const paidInvoices = MOCK_INVOICES.filter((i) => i.status === "paid");
const outstandingInvoices = MOCK_INVOICES.filter((i) =>
  ["sent", "partial"].includes(i.status),
);
const overdueInvoices = MOCK_INVOICES.filter((i) => i.status === "overdue");

export const MOCK_DASHBOARD_STATS = {
  totalRevenue: paidInvoices.reduce((s, i) => s + i.totalAmount, 0),
  totalExpenses: MOCK_EXPENSES.filter((e) => e.status === "approved").reduce(
    (s, e) => s + e.amount,
    0,
  ),
  netProfit:
    paidInvoices.reduce((s, i) => s + i.totalAmount, 0) -
    MOCK_EXPENSES.filter((e) => e.status === "approved").reduce(
      (s, e) => s + e.amount,
      0,
    ),
  paidInvoicesCount: paidInvoices.length,
  outstandingInvoicesCount: outstandingInvoices.length,
  overdueInvoicesCount: overdueInvoices.length,
  invoiceStatusBreakdown: {
    paid: paidInvoices.length,
    outstanding: outstandingInvoices.length,
    overdue: overdueInvoices.length,
  },
};

// ─── Chart Data ───────────────────────────────────────────────────────────────

export const MOCK_MONTHLY_REVENUE_EXPENSE = [
  { month: "Sep 2024", revenue: 380000, expenses: 210000 },
  { month: "Oct 2024", revenue: 520000, expenses: 295000 },
  { month: "Nov 2024", revenue: 445000, expenses: 260000 },
  { month: "Dec 2024", revenue: 610000, expenses: 320000 },
  { month: "Jan 2025", revenue: 485000, expenses: 257000 },
  { month: "Feb 2025", revenue: 720000, expenses: 380000 },
];

export const MOCK_MONTHLY_PROFIT = MOCK_MONTHLY_REVENUE_EXPENSE.map((m) => ({
  month: m.month,
  profit: calculateProfit(m.revenue, m.expenses),
}));
